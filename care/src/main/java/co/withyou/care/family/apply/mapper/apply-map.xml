<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="co.withyou.care.family.apply.mapper.ApplyMapper">
	
	<insert id="applyResultInsert" parameterType="ApplyVo">
		INSERT INTO serviceApply VALUES	( 
			service_sq.nextval, 
			#{serviceStartTime }, 
			(to_number(#{serviceEndTime})-to_number(#{serviceStartTime}))*(select codename from code where codeid='P01')*0.7,
			default,
			#{serviceEndTime },
			(to_number(#{serviceEndTime})-to_number(#{serviceStartTime}))*(select codename from code where codeid='P01'),
			#{serviceDate},
			#{serviceDemand},
			null,
			SELECT P.PATIENTNO "patientNo"
			FROM PATIENT P, FAMILY F 
			WHERE P.FAMILYNO = F.FAMILYNO
			AND F.FAMILYNO = #{familyNo},
			sysdate,
			#{serviceArea}
			)
	</insert>
	
</mapper>